"use strict";(self["webpackChunksimple_twitter"]=self["webpackChunksimple_twitter"]||[]).push([[274],{266:function(t,e,s){s.d(e,{Z:function(){return w}});var r=function(){var t=this,e=t._self._c;return t.isLoading?e("Spinner"):e("div",{staticClass:"reply__card__wrapper"},t._l(t.replies,(function(s){return e("router-link",{key:s.id,staticClass:"reply__card",attrs:{to:{name:"reply",params:{id:s.TweetId}}}},[e("div",{staticClass:"reply__card__content"},[e("div",{staticClass:"reply__card__title"},[e("router-link",{attrs:{to:{name:"user-tweets",params:{id:s.replyUser.id}}}},[e("img",{staticClass:"reply__card__avatar",attrs:{src:t._f("emptyAvatar")(s.replyUser.avatar),alt:"avatar"}})]),e("div",[e("div",{staticClass:"reply__card__info"},[e("p",{staticClass:"reply__card__name"},[t._v(t._s(s.replyUser.name))]),e("p",{staticClass:"reply__card__account"},[t._v(" @"+t._s(s.replyUser.account))]),e("p",{staticClass:"reply__card__time"},[t._v("・"+t._s(t._f("fromNow")(s.createdAt)))])]),e("div",{staticClass:"reply__card__target"},[e("p",[t._v("回覆")]),e("p",{staticClass:"reply__card__target__account"},[t._v(" @"+t._s(s.tweetAuthorAccount)+" ")])])])],1),e("div",{staticClass:"reply__card__description"},[t._v(" "+t._s(s.comment)+" ")])])])})),1)},a=[],i=(s(541),s(1703),s(9682)),c=s(6950),n=s(6163),l=s(3459),o=s(8428),_={props:{newReply:{type:Object,default:()=>({createdAt:"",tweetAuthorAccount:"",comment:"",replyUser:{}})},isUpdated:{type:Boolean,default:!1}},watch:{newReply:{handler(t){this.replies.unshift(t)}},isUpdated(t,e){if("user-replies"===this.$route.name){const{id:t}=this.$route.params;this.fetchUserReplies(t)}}},mixins:[l.qk,l.XR],components:{Spinner:o.Z},data(){return{replies:[],isLoading:!0}},created(){if("user-replies"===this.$route.name){const{id:t}=this.$route.params;this.fetchUserReplies(t)}else if("reply"===this.$route.name){const{id:t}=this.$route.params;this.fetchReplies(t)}},methods:{async fetchUserReplies(t){try{const{data:e}=await i.Z.getUserReplies({userId:t});if("error"===e.status)throw new Error(e.message);this.replies=Object.values(e).map((t=>t)),this.isLoading=!1}catch(e){this.isLoading=!1,console.log("error",e),n.bW.fire({title:"無法取得回覆，請稍後再試"})}},async fetchReplies(t){try{const e=await c.Z.getReplies({tweetId:t}),{data:s}=e;if("error"===s.status)throw new Error(s.message);this.replies=Object.values(s).map((t=>t)),this.isLoading=!1}catch(e){console.log("error",e),n.bW.fire({title:"無法取得回覆，請稍後再試"})}}}},d=_,p=s(1001),u=(0,p.Z)(d,r,a,!1,null,"6e95a16a",null),w=u.exports},1274:function(t,e,s){s.r(e),s.d(e,{default:function(){return m}});var r=function(){var t=this,e=t._self._c;return t.isLoading?e("Spinner"):e("div",{staticClass:"reply__container"},[e("MainNav"),e("div",{staticClass:"reply"},[e("div",{staticClass:"reply__post"},[e("div",{staticClass:"reply__header"},[e("router-link",{attrs:{to:{name:"main"}}},[e("img",{attrs:{src:s(7841),alt:"arrow"}})]),e("h4",{staticClass:"reply__title"},[t._v("推文")])],1),e("div",{staticClass:"tweet__content"},[e("div",{staticClass:"tweet__title"},[e("router-link",{attrs:{to:{name:"user-tweets",params:{id:t.tweet.tweetAuthor.id}}}},[e("img",{staticClass:"tweet__avatar",attrs:{src:t._f("emptyAvatar")(t.tweet.tweetAuthor.avatar),alt:"avatar"}})]),e("div",[e("p",{staticClass:"tweet__name"},[t._v(t._s(t.tweet.tweetAuthor.name))]),e("p",{staticClass:"tweet__account"},[t._v("@"+t._s(t.tweet.tweetAuthor.account))])])],1),e("div",{staticClass:"tweet__description"},[t._v(" "+t._s(t.tweet.description)+" ")]),e("div",{staticClass:"tweet__time"},[t._v(t._s(t._f("timeFormat")(t.tweet.createdAt)))]),e("hr"),e("div",{staticClass:"tweet__count"},[e("p",{staticClass:"tweet__num"},[t._v(t._s(t.tweet.replyCounts))]),e("p",{staticClass:"tweet__reply"},[t._v("回覆")]),e("p",{staticClass:"tweet__num"},[t._v(t._s(t.tweet.likeCounts))]),e("p",{staticClass:"tweet__like"},[t._v("喜歡次數")])]),e("hr"),e("div",{staticClass:"tweet__card__footer"},[e("img",{attrs:{src:s(9382),alt:"reply"},on:{click:function(e){t.showReplyModal=!0}}}),t.tweet.isLiked?e("img",{attrs:{src:s(9892),alt:"like"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.deleteLike(t.tweet.id)}}}):e("img",{attrs:{src:s(2155),alt:"like"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.addLike(t.tweet.id)}}})]),t.showReplyModal?e("ReplyModal",{attrs:{tweet:t.tweet,currentUser:t.currentUser},on:{close:function(e){t.showReplyModal=!1},successReply:t.successReplyToast}}):t._e()],1)]),e("ReplyCard",{attrs:{newReply:t.newReply}})],1),e("PopularList")],1)},a=[],i=(s(1703),s(8189)),c=s(266),n=s(446),l=s(1390),o=s(3459),_=s(629),d=s(6163),p=s(8428),u=s(7204),w={mixins:[o.qk,o.nS,o.XR],components:{MainNav:i.Z,ReplyCard:c.Z,PopularList:n.Z,Spinner:p.Z,ReplyModal:u.Z},data(){return{tweet:{id:-1,description:"",createdAt:"",tweetAuthor:{id:-1,avatar:"",name:"",account:""},isLiked:!1,likeCounts:"",replyCounts:""},isLoading:!0,showReplyModal:!1,newReply:{}}},computed:{...(0,_.rn)(["currentUser"])},created(){this.fetchTweet(this.$route.params.id)},methods:{async fetchTweet(t){try{const{data:e}=await l.Z.getTweet({tweetId:t});this.tweet={...this.tweet,...e},this.isLoading=!1}catch(e){this.isLoading=!1,console.log("error",e),d.bW.fire({title:"無法取得推文，請稍後再試"})}},async addLike(t){try{const e=await l.Z.addLike({tweet_id:t,userId:this.currentUser.id}),{data:s}=e;if("error"===s.status)throw new Error(s.message);this.tweet={...this.tweet,isLiked:!0,likeCounts:this.tweet.likeCounts+1}}catch(e){console.error("error",e),d.bW.fire({title:"無法對推文按愛心，請稍後再試"})}},async deleteLike(t){try{const e=await l.Z.deleteLike({tweet_id:t,userId:this.currentUser.id}),{data:s}=e;if("error"===s.status)throw new Error(s.message);this.tweet={...this.tweet,isLiked:!1,likeCounts:this.tweet.likeCounts-1}}catch(e){console.error("error",e),d.bW.fire({title:"無法對推文取消愛心，請稍後再試"})}},successReplyToast(t){this.newReply={createdAt:new Date,tweetAuthorAccount:this.tweet.tweetAuthor.account,comment:t.comment,replyUser:{avatar:this.currentUser.avatar,name:this.currentUser.name,account:this.currentUser.account}},this.tweet.replyCounts+=1,d.FN.fire({title:"回覆發送成功"})}}},h=w,A=s(1001),y=(0,A.Z)(h,r,a,!1,null,"3beacd5c",null),m=y.exports},7841:function(t){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAcCAYAAAAEN20fAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAB3SURBVHgB7dfBCcAgEATATSpICenM0q8E7cB44MME80iE288urPhzwAMR+J7Umlut7ynxg+vQDEKeCK8hODNERfDVCCGEEEL8RUTV3LD1zQluyt6WA/wUX9hXkzHM4hsmdFiFEUYYYZgYyr9mhjEQkzrg9kas5gJC0MMjt72jBgAAAABJRU5ErkJggg=="}}]);
//# sourceMappingURL=274.d3506846.js.map